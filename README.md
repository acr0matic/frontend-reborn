# Стартовый шаблон для верстки (Webpack)

## Навигация

1. [Установка](#установка)
2. [Быстрый старт](#быстрый-старт)
3. [Разработка](#разработка)
4. [Формат коммитов](#формат-коммитов)
5. [Полезные команды](#полезные-команды)
6. [Стандартная файловая структура](#стандартная-файловая-структура)
7. [Рекомендации по использованию](#рекомендации-по-использованию)
8. [Автоматическое обновление даты сборки](#автоматическое-обновление-даты-сборки)
9. [Предустановленные зависимости](#предустановленные-зависимости)
10. [Частые проблемы](#частые-проблемы)

## Установка

Необходимо установить [Node.js](https://nodejs.org/) и [Yarn](https://yarnpkg.com/) последних версий.
В качестве локального сервера используется Webpack Dev Server.

Клонируем репозиторий себе на компьютер:

```sh
git clone https://github.com/acr0matic/frontend-reborn
```

Переходим в каталог с проектом:

```sh
cd frontend-reborn
```

Установливаем все зависимости командой:

```sh
yarn
```

## Быстрый старт

```sh
yarn
yarn run dev
```

Далее редактируем файлы в папке `src/` — изменения будут подхватываться автоматически.

## Разработка

Для запуска локального сервера, открываем в корневом каталоге терминал и пишем

```sh
yarn run dev
```

После чего, в браузере автоматически откроется новая вкладка с корневой страницей и запустятся процессы отслеживания
изменения файлов

Для сборки проекта в единые бандлы и подготовки к деплою:

```sh
yarn run build
```

Для отправки на удаленный хост необходимо настроить переменные окружения и использовать команду:

```sh
yarn run deploy
```

### Настройка деплоя через переменные окружения

Скопируйте пример файла и заполните актуальные значения:

```sh
cp .env.example .env
```

Доступные переменные:

* `FTP_HOST` — адрес FTP-сервера.
* `FTP_USER` — имя пользователя FTP.
* `FTP_PASSWORD` — пароль FTP.
* `FTP_SECURE` — использовать защищенное соединение (`true`/`false`).

## Формат коммитов
В проекте используется простой и предсказуемый формат сообщений коммитов. Он нужен не для красоты, а чтобы:

- быстро понимать суть изменений без просмотра diff
- упрощать код-ревью
- удобно ориентироваться в истории проекта
- при необходимости автоматически генерировать changelog

### Доступные префиксы
| Тип коммита | Описание |
|------------|----------|
| feat       | Новая функциональность |
| fix        | Исправление ошибки |
| refactor   | Переработка кода без изменения логики |


### Общие правила
- Сообщения коммитов пишутся **на русском языке**
- Используется **настоящее время** (`add`, а не `added`)
- Коммит отвечает на вопрос: *что делает это изменение?*
- Один коммит — одна логическая задача

Рекомендуемый формат:

```text
type: short description
```

Пример:

```text
feat: add modal window for feedback form
```

### Что не стоит делать
- Смешивать разные типы изменений в одном коммите
- Делать коммиты вида `update`, `fixes`, `changes`
- Коммитить сломанный или неработающий код

### Почему это важно
Последовательный формат коммитов:
- экономит время всей команды
- упрощает поиск причин багов
- делает историю проекта читаемой

Если есть сомнения, какой тип выбрать — почти всегда лучше разделить изменения на несколько коммитов.

## Автоматическое обновление даты сборки

В проекте реализовано автоматическое определение даты последнего коммита Git, которая может использоваться в HTML-разметке (например, в футере сайта как «Дата последнего обновления»).

### Как это работает

* При запуске сборки (`yarn run dev` или `yarn run build`) Webpack выполняет команду Git и получает дату последнего коммита.
* Значение даты подставляется на этапе сборки и **вшивается в HTML**.
* В браузере Git не используется — дата обновляется только при пересборке проекта.

## Полезные команды

* `yarn run dev` — режим разработки с локальным сервером и hot reload.
* `yarn run build` — production-сборка.
* `yarn run build_wp` — сборка, дополнительно прогоняющая gulp-задачи `styles`, `scripts`, `layout` под Wordpress
* `yarn run deploy` — загрузка сборки на удаленный хост (настройка FTP — в `node_scripts/deploy.js`).

## Стандартная файловая структура

```
frontend-reborn
├── gulp_tasks
├── node_scripts
├── src
│   ├── assets
│   │   ├── favicons
│   │   ├── fonts
│   │   └── images
│   ├── js
│   │   ├── component
│   │   ├── global
│   │   ├── layout
│   │   ├── libs
│   │   └── utils
│   ├── layout
│   │   ├── block
│   │   ├── modal
│   │   └── template
│   ├── scss
│   │   ├── abstracts
│   │   ├── common
│   │   ├── layout
│   │   ├── settings
│   │   └── vendors
│   ├── index.html
│   └── page-home.html
├── gulpfile.js
├── package.json
└── webpack.config.js
```

* Корень папки:
  * ```package.json``` — список зависимостей и общая конфигурация проекта
  * ```webpack.config.js``` — настройки сборки Webpack
  * ```gulpfile.js``` — подключение gulp-задач для дополнительной обработки
  * ```.browserslistrc``` – список поддерживаемых браузеров
  * ```.editorconfig``` – единый формат настроек для всех IDE
  * ```.eslintrc``` — настройки ESLint
  * ```.gitattributes``` – настройки конца строк в файлах для репозитория
  * ```.gitignore``` – запрет на отслеживание версионности определенных файлов и каталогов
  * ```.postcssrc``` — конфигурация PostCSS
  * ```.stylelintrc``` — конфигурация Stylelint
  * ```.stylelintignore``` – запрет на отслеживание файлов Stylelint'ом
  * ```.yarnrc.yml``` – дополнительные параметры Yarn
* Папка ```src``` - используется во время разработки:
  * страницы сайта: ```src/*.html```
  * шрифты: ```src/assets/fonts```
  * изображения: ```src/assets/images```
  * фавиконы: ```src/assets/favicons```
  * JS-файлы: ```src/js```
  * HTML-файлы (шаблоны/фрагменты): ```src/layout```
  * SCSS-файлы: ```src/scss```
* Папка ```dist``` - папка для билда проекта, из нее с помощью команды ```yarn run deploy``` файлы отправляются на
  удаленный сервер.
* Папка ```node_scripts``` - папка с NPM-скриптами (deploy).
* Папка ```gulp_tasks``` - gulp-задачи, используемые в ```yarn run build_wp```.
* Папка ```node_modules``` - папка с NPM-зависимостями, никогда не трогаем

## Рекомендации по использованию

### Страницы проекта

Для упрощения разработки многостраничных сайтов был внедрен "шаблонизатор". С помощью тега
```<include src=""></include>``` можно встраивать любые файлы в разметку, в том числе ```.html```

* страницы проекта находятся в корне папки ```src/```
  * Страница-навигатор: ```src/index.html```
  * главная страница: ```src/page-home.html```
  * страницы собираются с помощью плагина [postHtmlInclude](https://www.npmjs.com/package/posthtml-include/v/1.2.0)
  * всевозможные карточки товаров, услуг и т.п. размещаем в отдельных [фрагментах](src/layout/template/)

Чтобы не засорять разметку SVG кодом, был внедрен еще один [плагин](https://www.npmjs.com/package/posthtml-inline-svg).
С помощью тега ```<inline src=""></inline>```, мы можем указывать путь к нужному векторному изображению. При таком
способе добавления, SVG проходит через минификацию и очистку от лишнего кода, нужно это учитывать, когда планируется
делать сложные анимации. Для этого лучше подключать через ```<include src=""></include>```

### Шрифты

Каждое семейство шрифтов необходимо разместить в [отдельной папке](src/assets/fonts/).

* шрифты находятся в папке ```src/assets/fonts```
  * используйте [форматы](https://caniuse.com/#search=woff) ```.woff``` и ```.woff2```
  * шрифты подключаются в файл ```src/scss/settings/_fonts.scss```
  * рекомендуется использовать шрифты локально, а не подключать из внешних источников
  * сконвертировать локальные шрифты можно с помощью [данного сервиса](https://transfonter.com/)
  * используйте только те толщины шрифтов, которые используюся по дизайн-макету

### Стили CSS

```
scss/
├── abstracts/
│   ├── _main.scss           # Главный файл
│   ├── mixins.scss          # Каталог с миксинами
│       ├── _container.scss  # Создание контейнеров
│       ├── _font.scss       # Миксин локального подключения шрифтов
│   ├── variables.scss       # Каталог с переменными
│       ├── _weight.scss     # Толщины шрифтов
│       ├── _z-index.scss    # Схема управления слоями
├── base/
│   ├── _common.scss         # Базовые стили применяющие после normalize
│   ├── _misc.scss           # Специфичные правила для блоков
│   ├── _reset.scss          # Сброс стандартных значений
├── layout/
│   ├── components/          # UI-компоненты (кнопки, инпуты, и прочая мелочь)
│   ├── global/              # Глобальные стили и базовые сущности
│   ├── misc/                # Вспомогательные и служебные стили
│   ├── pages/               # Стили страниц
│   │   ├── archive/         # Каталожные страницы
│   │   ├── common/          # Обычные страницы
│   │   ├── misc/            # Другие страницы (404, поиск и т.д.)
│   │   ├── single/          # Внутренние страницы каталогов
│   │   └── _main.scss       # Точка входа pages
│   ├── partials/            # Переиспользуемые крупные блоки
│   │   ├── block/           # Блоки
│   │   ├── card/            # Карточки
│   │   ├── section/         # Секции
│   │   └── _main.scss       # Точка входа partials
├── settings/
│   ├── _breakpoint.scss     # Брейкпоинты для медиазапросов
│   ├── _container.scss      # Ширины контейнеров
│   ├── _fonts.scss          # Подключение шрифтов
│   └── _vars.scss           # Настройка цветов, размеров шрифтов, скруглений и т.д.
├── vendors/
│   └── _vendors.scss        # Main vendors file
├── _settings.scss           # Sass Settings
└── main.scss                # Главная точка входа
```

### Скрипты JS

* Точка входа находится в `src/js`.
* Для удобства сопровождения выносите логику в отдельные модули и подключайте их в `src/js`.
* Общие утилиты можно хранить в папке `src/js/utils`.

## Предустановленные зависимости

В шаблон установлено несколько по моему личному опыту наиболее удобных и полезных библиотек

### JS-библиотеки

| Название         | Ссылка                                     | Описание                                                                                     |
|------------------|--------------------------------------------|----------------------------------------------------------------------------------------------|
| imask.js         | https://imask.js.org/                      | Различные маски для полей ввода, по умолчанию маска реализована для мобильного телефона (+7) |
| vanilla-lazyload | https://github.com/verlok/vanilla-lazyload | Гибкая и удобная библиотека реализующая ленивую загрузку для всевозможных элементов          |

### SASS-библиотеки

| Название    | Ссылка                                | Описание                                                               |
|-------------|---------------------------------------|------------------------------------------------------------------------|
| family.scss | https://lukyvj.github.io/family.scss/ | Удобные миксины для стилизации на основе нумерации в дереве элементов. |
| hamburgers  | https://jonsuh.com/hamburgers/        | Универсальные бургеры на любой вкус и цвет                             |
| sass-mq     | https://github.com/sass-mq/sass-mq    | Миксины для media-запросов                                             |

## Частые проблемы

### Дата сборки не обновляется
Проверьте, что проект находится в Git-репозитории и сборка запущена заново.

### Сборка падает без ошибок
Удалите `node_modules` и выполните `yarn install`.